<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="author" content="Jens Petit" />
  <meta name="dcterms.date" content="2020-10-29" />
  <title>Temporal Clustering using Dynamic Graph Embeddings</title>
  <style>
    html {
      line-height: 1.7;
      font-family: Georgia, serif;
      font-size: 8pt;
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 40em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      word-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 1em;
      }
    }
    @media print {
      body {
        background-color: transparent;
        color: black;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin-top: 1.7em;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.7em;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1.7em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1.7em 0 1.7em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      font-style: italic;
    }
    code {
      font-family: Menlo, Monaco, 'Lucida Console', Consolas, monospace;
      background-color: #f0f0f0;
      font-size: 85%;
      margin: 0;
      padding: .2em .4em;
    }
    pre {
      line-height: 1.5em;
      padding: 1em;
      background-color: #f0f0f0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin-top: 1.7em;
    }
    table {
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
    }
    th, td {
      border-bottom: 1px solid lightgray;
      padding: 1em 3em 1em 0;
    }
    header {
      margin-bottom: 6em;
      text-align: center;
    }
    nav a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
  <style>
  /*
   * I add this to html files generated with pandoc.
   */

  html {
    font-size: 100%;
    overflow-y: scroll;
    -webkit-text-size-adjust: 100%;
    -ms-text-size-adjust: 100%;
  }

  body {
    color: #444;
    font-family: Georgia, Palatino, 'Palatino Linotype', Times, 'Times New Roman', serif;
    font-size: 12px;
    line-height: 1.7;
    padding: 1em;
    margin: auto;
    max-width: 42em;
    background: #fefefe;
  }

  a {
    color: #0645ad;
    text-decoration: none;
  }

  a:visited {
    color: #0b0080;
  }

  a:hover {
    color: #06e;
  }

  a:active {
    color: #faa700;
  }

  a:focus {
    outline: thin dotted;
  }

  *::-moz-selection {
    background: rgba(255, 255, 0, 0.3);
    color: #000;
  }

  *::selection {
    background: rgba(255, 255, 0, 0.3);
    color: #000;
  }

  a::-moz-selection {
    background: rgba(255, 255, 0, 0.3);
    color: #0645ad;
  }

  a::selection {
    background: rgba(255, 255, 0, 0.3);
    color: #0645ad;
  }

  p {
    margin: 1em 0;
  }

  img {
    max-width: 100%;
  }

  h1, h2, h3, h4, h5, h6 {
    color: #111;
    line-height: 125%;
    margin-top: 2em;
    font-weight: normal;
  }

  h4, h5, h6 {
    font-weight: bold;
  }

  h1 {
    font-size: 2.5em;
  }

  h2 {
    font-size: 2em;
  }

  h3 {
    font-size: 1.5em;
  }

  h4 {
    font-size: 1.2em;
  }

  h5 {
    font-size: 1em;
  }

  h6 {
    font-size: 0.9em;
  }

  blockquote {
    color: #666666;
    margin: 0;
    padding-left: 3em;
    border-left: 0.5em #EEE solid;
  }

  hr {
    display: block;
    height: 2px;
    border: 0;
    border-top: 1px solid #aaa;
    border-bottom: 1px solid #eee;
    margin: 1em 0;
    padding: 0;
  }

  pre, code, kbd, samp {
    color: #000;
    font-family: monospace, monospace;
    _font-family: 'courier new', monospace;
    font-size: 0.98em;
  }

  code {
    overflow-x: scroll !important;
    white-space: pre !important;
  }

  pre {
    white-space: pre;
    white-space: pre-wrap;
    word-wrap: break-word;
  }

  b, strong {
    font-weight: bold;
  }

  dfn {
    font-style: italic;
  }

  ins {
    background: #ff9;
    color: #000;
    text-decoration: none;
  }

  mark {
    background: #ff0;
    color: #000;
    font-style: italic;
    font-weight: bold;
  }

  sub, sup {
    font-size: 75%;
    line-height: 0;
    position: relative;
    vertical-align: baseline;
  }

  sup {
    top: -0.5em;
  }

  sub {
    bottom: -0.25em;
  }

  ul, ol {
    margin: 1em 0;
    padding: 0 0 0 2em;
  }

  li p:last-child {
    margin-bottom: 0;
  }

  ul ul, ol ol {
    margin: .3em 0;
  }

  dl {
    margin-bottom: 1em;
  }

  dt {
    font-weight: bold;
    margin-bottom: .8em;
  }

  dd {
    margin: 0 0 .8em 2em;
  }

  dd:last-child {
    margin-bottom: 0;
  }

  img {
    border: 0;
    -ms-interpolation-mode: bicubic;
    vertical-align: middle;
  }

  figure {
    display: block;
    text-align: center;
    margin: 1em 0;
  }

  figure img {
    border: none;
    margin: 0 auto;
  }

  figcaption {
    font-size: 0.8em;
    font-style: italic;
    margin: 0 0 .8em;
  }

  table {
    margin-bottom: 2em;
    border-bottom: 1px solid #ddd;
    border-right: 1px solid #ddd;
    border-spacing: 0;
    border-collapse: collapse;
  }

  table th {
    padding: .2em 1em;
    background-color: #eee;
    border-top: 1px solid #ddd;
    border-left: 1px solid #ddd;
  }

  table td {
    padding: .2em 1em;
    border-top: 1px solid #ddd;
    border-left: 1px solid #ddd;
    vertical-align: top;
  }

  .author {
    font-size: 1.2em;
    text-align: center;
  }

  @media only screen and (min-width: 480px) {
    body {
      font-size: 14px;
    }
  }
  @media only screen and (min-width: 768px) {
    body {
      font-size: 16px;
    }
  }
  @media print {
    * {
      background: transparent !important;
      color: black !important;
      filter: none !important;
      -ms-filter: none !important;
    }

    body {
      font-size: 12pt;
      max-width: 100%;
    }

    a, a:visited {
      text-decoration: underline;
    }

    hr {
      height: 1px;
      border: 0;
      border-bottom: 1px solid black;
    }

    a[href]:after {
      content: " (" attr(href) ")";
    }

    abbr[title]:after {
      content: " (" attr(title) ")";
    }

    .ir a:after, a[href^="javascript:"]:after, a[href^="#"]:after {
      content: "";
    }

    pre, blockquote {
      border: 1px solid #999;
      padding-right: 1em;
      page-break-inside: avoid;
    }

    tr, img {
      page-break-inside: avoid;
    }

    img {
      max-width: 100% !important;
    }

    @page :left {
      margin: 15mm 20mm 15mm 10mm;
  }

    @page :right {
      margin: 15mm 10mm 15mm 20mm;
  }

    p, h2, h3 {
      orphans: 3;
      widows: 3;
    }

    h2, h3 {
      page-break-after: avoid;
    }
  }
  </style>
</head>
<body>
<header id="title-block-header">
<h1 class="title">Temporal Clustering using Dynamic Graph Embeddings</h1>
<p class="author">Jens Petit</p>
<p class="date">2020-10-29</p>
</header>
<h2 id="outline">Outline</h2>

<h1 id="dynamic-graph-representation-learning">Dynamic Graph Representation Learning</h1>
<h2 id="dynamic-graph-representation-learning-1">Dynamic Graph Representation Learning</h2>
<h3 id="discrete-time-dynamic-graphs-dtdg">Discrete-time dynamic graphs (DTDG)</h3>
<p>Sequences of static graph snapshots.</p>
<h3 id="continuous-time-dynamic-graphs-ctdg">Continuous-time dynamic graphs (CTDG)</h3>
<p>Timed list of events, including node addition, deletion and edge addition and deletion.</p>
<h2 id="temporal-graph-networks-tgn">Temporal Graph Networks (TGN)</h2>
<figure>
<embed src="tgn_general.pdf" style="width:65.0%" /><figcaption aria-hidden="true">General encoder-decoder framework</figcaption>
</figure>
<p>Current decoders:</p>
<ul>
<li>future edge (‘link’) prediction</li>
<li>dynamic node classification</li>
</ul>
<p>Problem settings:</p>
<ul>
<li>Transductive: only nodes which have been used in training</li>
<li>Inductive: additionally nodes which have <em>not</em> been used in training</li>
</ul>
<h2 id="example-tgn-for-future-link-prediction">Example: TGN for future link prediction</h2>
<p>Datasets:</p>
<ul>
<li>Reddit, Wikipedia: Bipartite interaction graphs with users and subreddits/pages as nodes.</li>
<li>Twitter: Users are nodes and retweets are interactions.</li>
</ul>
<p>All interaction events carry text features (tweets, edits, posts) and 70%-15%-15% (train-valid-test) chronological split is used.</p>
<p>Exemplary decoder: simple MLP decoder mapping from the concatenation of two node embeddings to the probability of the edge</p>
<h2 id="example-tgn-encoder-embedding-computation">Example: TGN encoder embedding computation</h2>
<figure>
<img src="tgn_computations.png" style="width:65.0%" alt="TGN computations on a single batch of time-stamped interactions." /><figcaption aria-hidden="true">TGN computations on a single batch of time-stamped interactions<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>.</figcaption>
</figure>
<p><span class="math display"><strong>z</strong><sub><em>i</em></sub>(<em>t</em>) = <em>e</em><em>m</em><em>b</em>(<em>i</em>, <em>t</em>) = ∑<sub><em>j</em> ∈ 𝒩<sub><em>i</em></sub><sup><em>k</em></sup>([0, <em>t</em>])</sub><em>h</em>(<strong>s</strong><sub><em>i</em></sub>(<em>t</em>),<strong>s</strong><sub><em>j</em></sub>(<em>t</em>),<strong>e</strong><sub><em>i</em><em>j</em></sub>,<strong>v</strong><sub><em>i</em></sub>(<em>t</em>),<strong>v</strong><sub><em>j</em></sub>(<em>t</em>)),</span></p>
<h2 id="example-tgn-encoder-message-computation">Example: TGN encoder message computation</h2>
<figure>
<img src="tgn_computations.png" style="width:65.0%" alt="TGN computations on a single batch of time-stamped interactions." /><figcaption aria-hidden="true">TGN computations on a single batch of time-stamped interactions.</figcaption>
</figure>
<p><span class="math display"><strong>m</strong><sub><em>i</em></sub>(<em>t</em>) = <em>m</em><em>s</em><em>g</em>(<strong>s</strong><sub><em>i</em></sub>(<em>t</em><sup>−</sup>),<strong>s</strong><sub><em>j</em></sub>(<em>t</em><sup>−</sup>),<em>Δ</em><em>t</em>,<strong>e</strong><sub><em>i</em><em>j</em></sub>(<em>t</em>))</span></p>
<h2 id="example-tgn-encoder-message-aggregator">Example: TGN encoder message aggregator</h2>
<figure>
<img src="tgn_computations.png" style="width:65.0%" alt=" " /><figcaption aria-hidden="true"> </figcaption>
</figure>
<p>Combine all messages in a single batch for a specific node: <span class="math display">$$
\bar{\mathbf{m}}_i(t) = \mathrm{agg}\left(\mathbf{m}_i(t_1), \hdots, \mathbf{m}_i(t_b)\right)
$$</span></p>
<h2 id="example-tgn-encoder-message-memory-update">Example: TGN encoder message memory update</h2>
<figure>
<img src="tgn_computations.png" style="width:65.0%" alt="TGN computations on a single batch of time-stamped interactions." /><figcaption aria-hidden="true">TGN computations on a single batch of time-stamped interactions.</figcaption>
</figure>
<p>Using a Recurrent Neural Network: <span class="math display">$$
\mathbf{s}_i(t) = \mathrm{mem}\left(\bar{\mathbf{m}}_i(t), \mathbf{s}_i(t^-)\right)
$$</span></p>
<h2 id="example-baselines-using-standard-gcns">Example: Baselines using standard GCNs</h2>
<h1 id="gdelt-dataset">GDELT Dataset</h1>
<h2 id="the-gdelt-dataset">The GDELT Dataset</h2>
<blockquote>
<p>“The GDELT Project monitors the world’s broadcast, print, and web news from nearly every corner of every country in over 100 languages and identifies the people, locations, organizations, themes, sources, emotions, counts, quotes, images and events driving our global society every second of every day, creating a free open platform for computing on the entire world.”</p>
</blockquote>
<ul>
<li>Global Knowledge Graph</li>
<li>Global Event Database</li>
<li>Global Entity Graph</li>
<li>Global Frontpage Graph</li>
</ul>
<h2 id="the-global-entity-graph">The Global Entity Graph</h2>
<p>Random sample of news articles every 15 minutes (roughly 100k per day)</p>
<p>Google NLP API extracts entities from each article</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode json"><code class="sourceCode json"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;url&quot;</span><span class="fu">:</span> <span class="st">&quot;https://chicago.suntimes.com/news/washington-state-ends-racially-biased-death-penalty/&quot;</span><span class="fu">,</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;lang&quot;</span><span class="fu">:</span> <span class="st">&quot;en&quot;</span><span class="fu">,</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;date&quot;</span><span class="fu">:</span> <span class="st">&quot;2018-10-12T00:15:00Z&quot;</span><span class="fu">,</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;score&quot;</span><span class="fu">:</span> <span class="fl">-0.2</span><span class="fu">,</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;magnitude&quot;</span><span class="fu">:</span> <span class="fl">12.3</span><span class="fu">,</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;entities&quot;</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">{</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;name&quot;</span><span class="fu">:</span> <span class="st">&quot;Supreme Court&quot;</span><span class="fu">,</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;type&quot;</span><span class="fu">:</span> <span class="st">&quot;ORGANIZATION&quot;</span><span class="fu">,</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;numMentions&quot;</span><span class="fu">:</span> <span class="dv">1</span><span class="fu">,</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;avgSalience&quot;</span><span class="fu">:</span> <span class="fl">0.04405</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">}</span><span class="ot">,</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>    <span class="er">...</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="er">}</span></span></code></pre></div>
<h2 id="creating-a-graph">Creating a Graph</h2>
<p>Each pair of entities occurring in a single article correspond to an edge event with timestamp:</p>
<pre><code>Nathan Trott        RB Leipzig
Manchester United   RB Leipzig
West Ham            RB Leipzig
Timo Werner         RB Leipzig
Ralf Rangnick       RB Leipzig
Bundesliga          RB Leipzig
Patrick Dempsey     Leipzig
Leipzig             Germany
Patrick Dempsey     Leipzig
Leipzig             Germany
Patrick Dempsey     Leipzig
Leipzig             Germany
...</code></pre>
<p>Restricting to the 4 most salient entities gives roughly 200k edges per day</p>
<h1 id="research-idea">Research Idea</h1>
<h2 id="research-idea-temporal-clustering">Research Idea: Temporal Clustering</h2>
<ul>
<li>create temporal graph embedding with existing techniques like TGN or TGAT</li>
<li>instead of doing link prediction or node classification, the decoder is an RNN which predicts the future #Occurrences per day for a given entity and time horizon</li>
</ul>
<p><img src="architecture.png" /></p>
<h2 id="why-is-this-interesting">Why is this interesting?</h2>
<ul>
<li>the neighborhood should be strong indicator for future behavior -&gt; if all my neighbors are getting popular, then it is very likely that I will too</li>
<li>baseline: time series prediction for #Occurrences (no neighborhood info)</li>
<li>instead of immediate similarity for link prediction, the neighborhood in the embedding space represents similar temporal activity -&gt; clustering</li>
</ul>
<h2 id="open-questions-and-challenges">Open Questions and Challenges</h2>
<div class="columns">
<div class="column">
<p><img src="architecture.png" /></p>
</div><div class="column">
<p>right</p>
</div>
</div>
<section class="footnotes" role="doc-endnotes">
<hr />
<ol>
<li id="fn1" role="doc-endnote"><p>Figure taken from “Temporal Graph Networks For Deep Learning on Dynamic Graphs, <em>Rossi et al.</em>”<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>
</body>
</html>
